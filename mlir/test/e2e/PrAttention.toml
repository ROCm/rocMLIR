directory = "PrAttention"
prefix = "rocmlir-gen"
suffix = "--operation attention --arch %arch -pv %random_data %rocmlir_gen_flags | rocmlir-driver -c | mlir-cpu-runner -O2 --shared-libs=%linalg_test_lib_dir/libmlir_rocm_runtime%shlibext,%conv_validation_wrapper_library_dir/libconv-validation-wrappers%shlibext,%linalg_test_lib_dir/libmlir_runner_utils%shlibext,%linalg_test_lib_dir/libmlir_float16_utils%shlibext --entry-point-result=void | FileCheck %s --check-prefix="

[[axis]]
name = "operation"
values = ["attention"]
prefix = "--operation "

[[axis]]
name = "transK"
values = ["true", "false"]
prefix = "--transK="

## attention variant
[[suite]]
name = "pr_attention"

[[suite.test]]
config = "-seq_len 384 -num_heads 64 -t f32 -relDiff_threshold 0.000004"

[[suite.test]]
config = "-seq_len 384 -num_heads 64 -t f16 -relDiff_threshold 0.02 -absDiff_threshold 0.02 -RMS_threshold 0.008"

[[suite.test]]
config = "-seq_len 64 -num_heads 64 -t f16 -relDiff_threshold 0.002 -absDiff_threshold 0.002 -RMS_threshold 0.002"
