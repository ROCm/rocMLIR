// NOTE: Assertions have been autogenerated by utils/update_cc_test_checks.py UTC_ARGS: --check-globals smart
// FIXME: Edited after utils/update_cc_test_checks.py to fix !DIFile checks
// REQUIRES: amdgpu-registered-target
// RUN: %clang_cc1 -x hip -triple amdgcn-amd-amdhsa -emit-llvm -fcuda-is-device -debug-info-kind=limited -gheterogeneous-dwarf=diexpr -o - %s | FileCheck --check-prefix=DIEXPR-IR %s
// RUN: %clang_cc1 -x hip -triple amdgcn-amd-amdhsa -emit-llvm -fcuda-is-device -debug-info-kind=limited -gheterogeneous-dwarf=diexpression -o - %s | FileCheck --check-prefix=DIEXPRESSION-IR %s

#define __global__ __attribute__((global))
#define __device__ __attribute__((device))
#define __shared__ __attribute__((shared))
#define __constant__ __attribute__((constant))

__shared__ int GlobalSharedA;
__shared__ int GlobalSharedB;
__device__ int GlobalDeviceA;
__device__ int GlobalDeviceB;
__constant__ int GlobalConstantA;
__constant__ int GlobalConstantB;

// DIEXPR-IR-LABEL: @_Z7kernel1i(
// DIEXPR-IR-NEXT:  entry:
// DIEXPR-IR-NEXT:    [[ARG_ADDR:%.*]] = alloca i32, align 4, addrspace(5)
// DIEXPR-IR-NEXT:    [[KERNELVARA:%.*]] = alloca i32, align 4, addrspace(5)
// DIEXPR-IR-NEXT:    [[KERNELVARB:%.*]] = alloca i32, align 4, addrspace(5)
// DIEXPR-IR-NEXT:    [[KERNELVARSHAREDAPOINTER:%.*]] = alloca ptr, align 8, addrspace(5)
// DIEXPR-IR-NEXT:    [[KERNELVARSHAREDBPOINTER:%.*]] = alloca ptr, align 8, addrspace(5)
// DIEXPR-IR-NEXT:    [[KERNELVARAPOINTER:%.*]] = alloca ptr, align 8, addrspace(5)
// DIEXPR-IR-NEXT:    [[KERNELVARBPOINTER:%.*]] = alloca ptr, align 8, addrspace(5)
// DIEXPR-IR-NEXT:    [[ARG_ADDR_ASCAST:%.*]] = addrspacecast ptr addrspace(5) [[ARG_ADDR]] to ptr
// DIEXPR-IR-NEXT:    [[KERNELVARA_ASCAST:%.*]] = addrspacecast ptr addrspace(5) [[KERNELVARA]] to ptr
// DIEXPR-IR-NEXT:    [[KERNELVARB_ASCAST:%.*]] = addrspacecast ptr addrspace(5) [[KERNELVARB]] to ptr
// DIEXPR-IR-NEXT:    [[KERNELVARSHAREDAPOINTER_ASCAST:%.*]] = addrspacecast ptr addrspace(5) [[KERNELVARSHAREDAPOINTER]] to ptr
// DIEXPR-IR-NEXT:    [[KERNELVARSHAREDBPOINTER_ASCAST:%.*]] = addrspacecast ptr addrspace(5) [[KERNELVARSHAREDBPOINTER]] to ptr
// DIEXPR-IR-NEXT:    [[KERNELVARAPOINTER_ASCAST:%.*]] = addrspacecast ptr addrspace(5) [[KERNELVARAPOINTER]] to ptr
// DIEXPR-IR-NEXT:    [[KERNELVARBPOINTER_ASCAST:%.*]] = addrspacecast ptr addrspace(5) [[KERNELVARBPOINTER]] to ptr
// DIEXPR-IR-NEXT:    store i32 [[ARG:%.*]], ptr [[ARG_ADDR_ASCAST]], align 4
// DIEXPR-IR-NEXT:    call void @llvm.dbg.def(metadata [[META45:![0-9]+]], metadata ptr addrspace(5) [[ARG_ADDR]]), !dbg [[DBG46:![0-9]+]]
// DIEXPR-IR-NEXT:    call void @llvm.dbg.def(metadata [[META47:![0-9]+]], metadata ptr addrspace(5) [[KERNELVARA]]), !dbg [[DBG48:![0-9]+]]
// DIEXPR-IR-NEXT:    call void @llvm.dbg.def(metadata [[META49:![0-9]+]], metadata ptr addrspace(5) [[KERNELVARB]]), !dbg [[DBG50:![0-9]+]]
// DIEXPR-IR-NEXT:    call void @llvm.dbg.def(metadata [[META51:![0-9]+]], metadata ptr addrspace(5) [[KERNELVARSHAREDAPOINTER]]), !dbg [[DBG52:![0-9]+]]
// DIEXPR-IR-NEXT:    store ptr addrspacecast (ptr addrspace(3) @_ZZ7kernel1iE16KernelVarSharedA to ptr), ptr [[KERNELVARSHAREDAPOINTER_ASCAST]], align 8, !dbg [[DBG52]]
// DIEXPR-IR-NEXT:    call void @llvm.dbg.def(metadata [[META53:![0-9]+]], metadata ptr addrspace(5) [[KERNELVARSHAREDBPOINTER]]), !dbg [[DBG54:![0-9]+]]
// DIEXPR-IR-NEXT:    store ptr addrspacecast (ptr addrspace(3) @_ZZ7kernel1iE16KernelVarSharedB to ptr), ptr [[KERNELVARSHAREDBPOINTER_ASCAST]], align 8, !dbg [[DBG54]]
// DIEXPR-IR-NEXT:    call void @llvm.dbg.def(metadata [[META55:![0-9]+]], metadata ptr addrspace(5) [[KERNELVARAPOINTER]]), !dbg [[DBG56:![0-9]+]]
// DIEXPR-IR-NEXT:    store ptr [[KERNELVARA_ASCAST]], ptr [[KERNELVARAPOINTER_ASCAST]], align 8, !dbg [[DBG56]]
// DIEXPR-IR-NEXT:    call void @llvm.dbg.def(metadata [[META57:![0-9]+]], metadata ptr addrspace(5) [[KERNELVARBPOINTER]]), !dbg [[DBG58:![0-9]+]]
// DIEXPR-IR-NEXT:    store ptr [[KERNELVARB_ASCAST]], ptr [[KERNELVARBPOINTER_ASCAST]], align 8, !dbg [[DBG58]]
// DIEXPR-IR-NEXT:    ret void, !dbg [[DBG59:![0-9]+]]
//
// DIEXPRESSION-IR-LABEL: @_Z7kernel1i(
// DIEXPRESSION-IR-NEXT:  entry:
// DIEXPRESSION-IR-NEXT:    [[ARG_ADDR:%.*]] = alloca i32, align 4, addrspace(5)
// DIEXPRESSION-IR-NEXT:    [[KERNELVARA:%.*]] = alloca i32, align 4, addrspace(5)
// DIEXPRESSION-IR-NEXT:    [[KERNELVARB:%.*]] = alloca i32, align 4, addrspace(5)
// DIEXPRESSION-IR-NEXT:    [[KERNELVARSHAREDAPOINTER:%.*]] = alloca ptr, align 8, addrspace(5)
// DIEXPRESSION-IR-NEXT:    [[KERNELVARSHAREDBPOINTER:%.*]] = alloca ptr, align 8, addrspace(5)
// DIEXPRESSION-IR-NEXT:    [[KERNELVARAPOINTER:%.*]] = alloca ptr, align 8, addrspace(5)
// DIEXPRESSION-IR-NEXT:    [[KERNELVARBPOINTER:%.*]] = alloca ptr, align 8, addrspace(5)
// DIEXPRESSION-IR-NEXT:    [[ARG_ADDR_ASCAST:%.*]] = addrspacecast ptr addrspace(5) [[ARG_ADDR]] to ptr
// DIEXPRESSION-IR-NEXT:    [[KERNELVARA_ASCAST:%.*]] = addrspacecast ptr addrspace(5) [[KERNELVARA]] to ptr
// DIEXPRESSION-IR-NEXT:    [[KERNELVARB_ASCAST:%.*]] = addrspacecast ptr addrspace(5) [[KERNELVARB]] to ptr
// DIEXPRESSION-IR-NEXT:    [[KERNELVARSHAREDAPOINTER_ASCAST:%.*]] = addrspacecast ptr addrspace(5) [[KERNELVARSHAREDAPOINTER]] to ptr
// DIEXPRESSION-IR-NEXT:    [[KERNELVARSHAREDBPOINTER_ASCAST:%.*]] = addrspacecast ptr addrspace(5) [[KERNELVARSHAREDBPOINTER]] to ptr
// DIEXPRESSION-IR-NEXT:    [[KERNELVARAPOINTER_ASCAST:%.*]] = addrspacecast ptr addrspace(5) [[KERNELVARAPOINTER]] to ptr
// DIEXPRESSION-IR-NEXT:    [[KERNELVARBPOINTER_ASCAST:%.*]] = addrspacecast ptr addrspace(5) [[KERNELVARBPOINTER]] to ptr
// DIEXPRESSION-IR-NEXT:    store i32 [[ARG:%.*]], ptr [[ARG_ADDR_ASCAST]], align 4
// DIEXPRESSION-IR-NEXT:      #dbg_declare(ptr addrspace(5) [[ARG_ADDR]], [[META23:![0-9]+]], !DIExpression(DIOpArg(0, ptr addrspace(5)), DIOpDeref(i32)), [[META38:![0-9]+]])
// DIEXPRESSION-IR-NEXT:      #dbg_declare(ptr addrspace(5) [[KERNELVARA]], [[META24:![0-9]+]], !DIExpression(DIOpArg(0, ptr addrspace(5)), DIOpDeref(i32)), [[META39:![0-9]+]])
// DIEXPRESSION-IR-NEXT:      #dbg_declare(ptr addrspace(5) [[KERNELVARB]], [[META25:![0-9]+]], !DIExpression(DIOpArg(0, ptr addrspace(5)), DIOpDeref(i32)), [[META40:![0-9]+]])
// DIEXPRESSION-IR-NEXT:      #dbg_declare(ptr addrspace(5) [[KERNELVARSHAREDAPOINTER]], [[META26:![0-9]+]], !DIExpression(DIOpArg(0, ptr addrspace(5)), DIOpDeref(ptr)), [[META41:![0-9]+]])
// DIEXPRESSION-IR-NEXT:    store ptr addrspacecast (ptr addrspace(3) @_ZZ7kernel1iE16KernelVarSharedA to ptr), ptr [[KERNELVARSHAREDAPOINTER_ASCAST]], align 8, !dbg [[META41]]
// DIEXPRESSION-IR-NEXT:      #dbg_declare(ptr addrspace(5) [[KERNELVARSHAREDBPOINTER]], [[META28:![0-9]+]], !DIExpression(DIOpArg(0, ptr addrspace(5)), DIOpDeref(ptr)), [[META42:![0-9]+]])
// DIEXPRESSION-IR-NEXT:    store ptr addrspacecast (ptr addrspace(3) @_ZZ7kernel1iE16KernelVarSharedB to ptr), ptr [[KERNELVARSHAREDBPOINTER_ASCAST]], align 8, !dbg [[META42]]
// DIEXPRESSION-IR-NEXT:      #dbg_declare(ptr addrspace(5) [[KERNELVARAPOINTER]], [[META29:![0-9]+]], !DIExpression(DIOpArg(0, ptr addrspace(5)), DIOpDeref(ptr)), [[META43:![0-9]+]])
// DIEXPRESSION-IR-NEXT:    store ptr [[KERNELVARA_ASCAST]], ptr [[KERNELVARAPOINTER_ASCAST]], align 8, !dbg [[META43]]
// DIEXPRESSION-IR-NEXT:      #dbg_declare(ptr addrspace(5) [[KERNELVARBPOINTER]], [[META30:![0-9]+]], !DIExpression(DIOpArg(0, ptr addrspace(5)), DIOpDeref(ptr)), [[META44:![0-9]+]])
// DIEXPRESSION-IR-NEXT:    store ptr [[KERNELVARB_ASCAST]], ptr [[KERNELVARBPOINTER_ASCAST]], align 8, !dbg [[META44]]
// DIEXPRESSION-IR-NEXT:    ret void, !dbg [[DBG45:![0-9]+]]
//
__global__ void kernel1(int Arg) {
  __shared__ int KernelVarSharedA;
  __shared__ int KernelVarSharedB;
  int KernelVarA;
  int KernelVarB;

  auto *KernelVarSharedAPointer = &KernelVarSharedA;
  auto *KernelVarSharedBPointer = &KernelVarSharedB;
  auto *KernelVarAPointer = &KernelVarA;
  auto *KernelVarBPointer = &KernelVarB;
}

// DIEXPR-IR-LABEL: @_Z5func1i(
// DIEXPR-IR-NEXT:  entry:
// DIEXPR-IR-NEXT:    [[ARG_ADDR:%.*]] = alloca i32, align 4, addrspace(5)
// DIEXPR-IR-NEXT:    [[FUNCVARA:%.*]] = alloca i32, align 4, addrspace(5)
// DIEXPR-IR-NEXT:    [[FUNCVARB:%.*]] = alloca i32, align 4, addrspace(5)
// DIEXPR-IR-NEXT:    [[FUNCVARAPOINTER:%.*]] = alloca ptr, align 8, addrspace(5)
// DIEXPR-IR-NEXT:    [[FUNCVARBPOINTER:%.*]] = alloca ptr, align 8, addrspace(5)
// DIEXPR-IR-NEXT:    [[ARG_ADDR_ASCAST:%.*]] = addrspacecast ptr addrspace(5) [[ARG_ADDR]] to ptr
// DIEXPR-IR-NEXT:    [[FUNCVARA_ASCAST:%.*]] = addrspacecast ptr addrspace(5) [[FUNCVARA]] to ptr
// DIEXPR-IR-NEXT:    [[FUNCVARB_ASCAST:%.*]] = addrspacecast ptr addrspace(5) [[FUNCVARB]] to ptr
// DIEXPR-IR-NEXT:    [[FUNCVARAPOINTER_ASCAST:%.*]] = addrspacecast ptr addrspace(5) [[FUNCVARAPOINTER]] to ptr
// DIEXPR-IR-NEXT:    [[FUNCVARBPOINTER_ASCAST:%.*]] = addrspacecast ptr addrspace(5) [[FUNCVARBPOINTER]] to ptr
// DIEXPR-IR-NEXT:    store i32 [[ARG:%.*]], ptr [[ARG_ADDR_ASCAST]], align 4
// DIEXPR-IR-NEXT:    call void @llvm.dbg.def(metadata [[META67:![0-9]+]], metadata ptr addrspace(5) [[ARG_ADDR]]), !dbg [[DBG68:![0-9]+]]
// DIEXPR-IR-NEXT:    call void @llvm.dbg.def(metadata [[META69:![0-9]+]], metadata ptr addrspace(5) [[FUNCVARA]]), !dbg [[DBG70:![0-9]+]]
// DIEXPR-IR-NEXT:    call void @llvm.dbg.def(metadata [[META71:![0-9]+]], metadata ptr addrspace(5) [[FUNCVARB]]), !dbg [[DBG72:![0-9]+]]
// DIEXPR-IR-NEXT:    call void @llvm.dbg.def(metadata [[META73:![0-9]+]], metadata ptr addrspace(5) [[FUNCVARAPOINTER]]), !dbg [[DBG74:![0-9]+]]
// DIEXPR-IR-NEXT:    store ptr [[FUNCVARA_ASCAST]], ptr [[FUNCVARAPOINTER_ASCAST]], align 8, !dbg [[DBG74]]
// DIEXPR-IR-NEXT:    call void @llvm.dbg.def(metadata [[META75:![0-9]+]], metadata ptr addrspace(5) [[FUNCVARBPOINTER]]), !dbg [[DBG76:![0-9]+]]
// DIEXPR-IR-NEXT:    store ptr [[FUNCVARB_ASCAST]], ptr [[FUNCVARBPOINTER_ASCAST]], align 8, !dbg [[DBG76]]
// DIEXPR-IR-NEXT:    ret void, !dbg [[DBG77:![0-9]+]]
//
// DIEXPRESSION-IR-LABEL: @_Z5func1i(
// DIEXPRESSION-IR-NEXT:  entry:
// DIEXPRESSION-IR-NEXT:    [[ARG_ADDR:%.*]] = alloca i32, align 4, addrspace(5)
// DIEXPRESSION-IR-NEXT:    [[FUNCVARA:%.*]] = alloca i32, align 4, addrspace(5)
// DIEXPRESSION-IR-NEXT:    [[FUNCVARB:%.*]] = alloca i32, align 4, addrspace(5)
// DIEXPRESSION-IR-NEXT:    [[FUNCVARAPOINTER:%.*]] = alloca ptr, align 8, addrspace(5)
// DIEXPRESSION-IR-NEXT:    [[FUNCVARBPOINTER:%.*]] = alloca ptr, align 8, addrspace(5)
// DIEXPRESSION-IR-NEXT:    [[ARG_ADDR_ASCAST:%.*]] = addrspacecast ptr addrspace(5) [[ARG_ADDR]] to ptr
// DIEXPRESSION-IR-NEXT:    [[FUNCVARA_ASCAST:%.*]] = addrspacecast ptr addrspace(5) [[FUNCVARA]] to ptr
// DIEXPRESSION-IR-NEXT:    [[FUNCVARB_ASCAST:%.*]] = addrspacecast ptr addrspace(5) [[FUNCVARB]] to ptr
// DIEXPRESSION-IR-NEXT:    [[FUNCVARAPOINTER_ASCAST:%.*]] = addrspacecast ptr addrspace(5) [[FUNCVARAPOINTER]] to ptr
// DIEXPRESSION-IR-NEXT:    [[FUNCVARBPOINTER_ASCAST:%.*]] = addrspacecast ptr addrspace(5) [[FUNCVARBPOINTER]] to ptr
// DIEXPRESSION-IR-NEXT:    store i32 [[ARG:%.*]], ptr [[ARG_ADDR_ASCAST]], align 4
// DIEXPRESSION-IR-NEXT:      #dbg_declare(ptr addrspace(5) [[ARG_ADDR]], [[META48:![0-9]+]], !DIExpression(DIOpArg(0, ptr addrspace(5)), DIOpDeref(i32)), [[META53:![0-9]+]])
// DIEXPRESSION-IR-NEXT:      #dbg_declare(ptr addrspace(5) [[FUNCVARA]], [[META49:![0-9]+]], !DIExpression(DIOpArg(0, ptr addrspace(5)), DIOpDeref(i32)), [[META54:![0-9]+]])
// DIEXPRESSION-IR-NEXT:      #dbg_declare(ptr addrspace(5) [[FUNCVARB]], [[META50:![0-9]+]], !DIExpression(DIOpArg(0, ptr addrspace(5)), DIOpDeref(i32)), [[META55:![0-9]+]])
// DIEXPRESSION-IR-NEXT:      #dbg_declare(ptr addrspace(5) [[FUNCVARAPOINTER]], [[META51:![0-9]+]], !DIExpression(DIOpArg(0, ptr addrspace(5)), DIOpDeref(ptr)), [[META56:![0-9]+]])
// DIEXPRESSION-IR-NEXT:    store ptr [[FUNCVARA_ASCAST]], ptr [[FUNCVARAPOINTER_ASCAST]], align 8, !dbg [[META56]]
// DIEXPRESSION-IR-NEXT:      #dbg_declare(ptr addrspace(5) [[FUNCVARBPOINTER]], [[META52:![0-9]+]], !DIExpression(DIOpArg(0, ptr addrspace(5)), DIOpDeref(ptr)), [[META57:![0-9]+]])
// DIEXPRESSION-IR-NEXT:    store ptr [[FUNCVARB_ASCAST]], ptr [[FUNCVARBPOINTER_ASCAST]], align 8, !dbg [[META57]]
// DIEXPRESSION-IR-NEXT:    ret void, !dbg [[DBG58:![0-9]+]]
//
__device__ void func1(int Arg) {
  int FuncVarA;
  int FuncVarB;

  auto *FuncVarAPointer = &FuncVarA;
  auto *FuncVarBPointer = &FuncVarB;
}

struct pair { int first, second; };
// DIEXPR-IR-LABEL: @_Z5func14pair(
// DIEXPR-IR-NEXT:  entry:
// DIEXPR-IR-NEXT:    [[P:%.*]] = alloca [[STRUCT_PAIR:%.*]], align 4, addrspace(5)
// DIEXPR-IR-NEXT:    [[P1:%.*]] = addrspacecast ptr addrspace(5) [[P]] to ptr
// DIEXPR-IR-NEXT:    store [2 x i32] [[P_COERCE:%.*]], ptr [[P1]], align 4
// DIEXPR-IR-NEXT:    call void @llvm.dbg.def(metadata [[META87:![0-9]+]], metadata ptr addrspace(5) [[P]]), !dbg [[DBG88:![0-9]+]]
// DIEXPR-IR-NEXT:    ret void, !dbg [[DBG89:![0-9]+]]
//
// DIEXPRESSION-IR-LABEL: @_Z5func14pair(
// DIEXPRESSION-IR-NEXT:  entry:
// DIEXPRESSION-IR-NEXT:    [[P:%.*]] = alloca [[STRUCT_PAIR:%.*]], align 4, addrspace(5)
// DIEXPRESSION-IR-NEXT:    [[P1:%.*]] = addrspacecast ptr addrspace(5) [[P]] to ptr
// DIEXPRESSION-IR-NEXT:    store [2 x i32] [[P_COERCE:%.*]], ptr [[P1]], align 4
// DIEXPRESSION-IR-NEXT:      #dbg_declare(ptr addrspace(5) [[P]], [[META67:![0-9]+]], !DIExpression(DIOpArg(0, ptr addrspace(5)), DIOpDeref([[STRUCT_PAIR]])), [[META68:![0-9]+]])
// DIEXPRESSION-IR-NEXT:    ret void, !dbg [[DBG69:![0-9]+]]
//
__device__ void func1(pair p) {}

//.
// DIEXPR-IR: [[META8:![0-9]+]] = distinct !DICompileUnit(language: DW_LANG_C_plus_plus_14, file: [[META9:![0-9]+]], producer: "{{.*}}clang version {{.*}}", isOptimized: false, runtimeVersion: 0, emissionKind: FullDebug, splitDebugInlining: false, nameTableKind: None)
// DIEXPR-IR: [[META9]] = !DIFile(filename: "{{.*}}", directory: {{.*}})
// DIEXPR-IR: [[META12:![0-9]+]] = !DIFile(filename: "{{.*}}", directory: {{.*}})
// DIEXPR-IR: [[META13:![0-9]+]] = !DIBasicType(name: "int", size: 32, encoding: DW_ATE_signed)
// DIEXPR-IR: [[META26:![0-9]+]] = distinct !DISubprogram(name: "kernel1", linkageName: "_Z7kernel1i", scope: [[META12]], file: [[META12]], line: 79, type: [[META27:![0-9]+]], scopeLine: 79, flags: DIFlagPrototyped, spFlags: DISPFlagDefinition, unit: [[META8]], retainedNodes: [[META29:![0-9]+]])
// DIEXPR-IR: [[META27]] = !DISubroutineType(types: [[META28:![0-9]+]])
// DIEXPR-IR: [[META28]] = !{null, [[META13]]}
// DIEXPR-IR: [[META29]] = !{[[META30:![0-9]+]], [[META31:![0-9]+]], [[META32:![0-9]+]], [[META33:![0-9]+]], [[META35:![0-9]+]], [[META36:![0-9]+]], [[META37:![0-9]+]]}
// DIEXPR-IR: [[META30]] = !DILocalVariable(name: "Arg", arg: 1, scope: [[META26]], file: [[META12]], line: 79, type: [[META13]])
// DIEXPR-IR: [[META31]] = !DILocalVariable(name: "KernelVarA", scope: [[META26]], file: [[META12]], line: 82, type: [[META13]])
// DIEXPR-IR: [[META32]] = !DILocalVariable(name: "KernelVarB", scope: [[META26]], file: [[META12]], line: 83, type: [[META13]])
// DIEXPR-IR: [[META33]] = !DILocalVariable(name: "KernelVarSharedAPointer", scope: [[META26]], file: [[META12]], line: 85, type: [[META34:![0-9]+]])
// DIEXPR-IR: [[META34]] = !DIDerivedType(tag: DW_TAG_pointer_type, baseType: [[META13]], size: 64)
// DIEXPR-IR: [[META35]] = !DILocalVariable(name: "KernelVarSharedBPointer", scope: [[META26]], file: [[META12]], line: 86, type: [[META34]])
// DIEXPR-IR: [[META36]] = !DILocalVariable(name: "KernelVarAPointer", scope: [[META26]], file: [[META12]], line: 87, type: [[META34]])
// DIEXPR-IR: [[META37]] = !DILocalVariable(name: "KernelVarBPointer", scope: [[META26]], file: [[META12]], line: 88, type: [[META34]])
// DIEXPR-IR: [[META45]] = distinct !DILifetime(object: [[META30]], location: !DIExpr(DIOpReferrer(ptr addrspace(5)), DIOpDeref(i32)))
// DIEXPR-IR: [[DBG46]] = !DILocation(line: 79, column: 29, scope: [[META26]])
// DIEXPR-IR: [[META47]] = distinct !DILifetime(object: [[META31]], location: !DIExpr(DIOpReferrer(ptr addrspace(5)), DIOpDeref(i32)))
// DIEXPR-IR: [[DBG48]] = !DILocation(line: 82, column: 7, scope: [[META26]])
// DIEXPR-IR: [[META49]] = distinct !DILifetime(object: [[META32]], location: !DIExpr(DIOpReferrer(ptr addrspace(5)), DIOpDeref(i32)))
// DIEXPR-IR: [[DBG50]] = !DILocation(line: 83, column: 7, scope: [[META26]])
// DIEXPR-IR: [[META51]] = distinct !DILifetime(object: [[META33]], location: !DIExpr(DIOpReferrer(ptr addrspace(5)), DIOpDeref(ptr)))
// DIEXPR-IR: [[DBG52]] = !DILocation(line: 85, column: 9, scope: [[META26]])
// DIEXPR-IR: [[META53]] = distinct !DILifetime(object: [[META35]], location: !DIExpr(DIOpReferrer(ptr addrspace(5)), DIOpDeref(ptr)))
// DIEXPR-IR: [[DBG54]] = !DILocation(line: 86, column: 9, scope: [[META26]])
// DIEXPR-IR: [[META55]] = distinct !DILifetime(object: [[META36]], location: !DIExpr(DIOpReferrer(ptr addrspace(5)), DIOpDeref(ptr)))
// DIEXPR-IR: [[DBG56]] = !DILocation(line: 87, column: 9, scope: [[META26]])
// DIEXPR-IR: [[META57]] = distinct !DILifetime(object: [[META37]], location: !DIExpr(DIOpReferrer(ptr addrspace(5)), DIOpDeref(ptr)))
// DIEXPR-IR: [[DBG58]] = !DILocation(line: 88, column: 9, scope: [[META26]])
// DIEXPR-IR: [[DBG59]] = !DILocation(line: 89, column: 1, scope: [[META26]])
// DIEXPR-IR: [[META60:![0-9]+]] = distinct !DISubprogram(name: "func1", linkageName: "_Z5func1i", scope: [[META12]], file: [[META12]], line: 135, type: [[META27]], scopeLine: 135, flags: DIFlagPrototyped, spFlags: DISPFlagDefinition, unit: [[META8]], retainedNodes: [[META61:![0-9]+]])
// DIEXPR-IR: [[META61]] = !{[[META62:![0-9]+]], [[META63:![0-9]+]], [[META64:![0-9]+]], [[META65:![0-9]+]], [[META66:![0-9]+]]}
// DIEXPR-IR: [[META62]] = !DILocalVariable(name: "Arg", arg: 1, scope: [[META60]], file: [[META12]], line: 135, type: [[META13]])
// DIEXPR-IR: [[META63]] = !DILocalVariable(name: "FuncVarA", scope: [[META60]], file: [[META12]], line: 136, type: [[META13]])
// DIEXPR-IR: [[META64]] = !DILocalVariable(name: "FuncVarB", scope: [[META60]], file: [[META12]], line: 137, type: [[META13]])
// DIEXPR-IR: [[META65]] = !DILocalVariable(name: "FuncVarAPointer", scope: [[META60]], file: [[META12]], line: 139, type: [[META34]])
// DIEXPR-IR: [[META66]] = !DILocalVariable(name: "FuncVarBPointer", scope: [[META60]], file: [[META12]], line: 140, type: [[META34]])
// DIEXPR-IR: [[META67]] = distinct !DILifetime(object: [[META62]], location: !DIExpr(DIOpReferrer(ptr addrspace(5)), DIOpDeref(i32)))
// DIEXPR-IR: [[DBG68]] = !DILocation(line: 135, column: 27, scope: [[META60]])
// DIEXPR-IR: [[META69]] = distinct !DILifetime(object: [[META63]], location: !DIExpr(DIOpReferrer(ptr addrspace(5)), DIOpDeref(i32)))
// DIEXPR-IR: [[DBG70]] = !DILocation(line: 136, column: 7, scope: [[META60]])
// DIEXPR-IR: [[META71]] = distinct !DILifetime(object: [[META64]], location: !DIExpr(DIOpReferrer(ptr addrspace(5)), DIOpDeref(i32)))
// DIEXPR-IR: [[DBG72]] = !DILocation(line: 137, column: 7, scope: [[META60]])
// DIEXPR-IR: [[META73]] = distinct !DILifetime(object: [[META65]], location: !DIExpr(DIOpReferrer(ptr addrspace(5)), DIOpDeref(ptr)))
// DIEXPR-IR: [[DBG74]] = !DILocation(line: 139, column: 9, scope: [[META60]])
// DIEXPR-IR: [[META75]] = distinct !DILifetime(object: [[META66]], location: !DIExpr(DIOpReferrer(ptr addrspace(5)), DIOpDeref(ptr)))
// DIEXPR-IR: [[DBG76]] = !DILocation(line: 140, column: 9, scope: [[META60]])
// DIEXPR-IR: [[DBG77]] = !DILocation(line: 141, column: 1, scope: [[META60]])
// DIEXPR-IR: [[META78:![0-9]+]] = distinct !DISubprogram(name: "func1", linkageName: "_Z5func14pair", scope: [[META12]], file: [[META12]], line: 160, type: [[META79:![0-9]+]], scopeLine: 160, flags: DIFlagPrototyped, spFlags: DISPFlagDefinition, unit: [[META8]], retainedNodes: [[META85:![0-9]+]])
// DIEXPR-IR: [[META79]] = !DISubroutineType(types: [[META80:![0-9]+]])
// DIEXPR-IR: [[META80]] = !{null, [[META81:![0-9]+]]}
// DIEXPR-IR: [[META81]] = distinct !DICompositeType(tag: DW_TAG_structure_type, name: "pair", file: [[META12]], line: 143, size: 64, flags: DIFlagTypePassByValue, elements: [[META82:![0-9]+]], identifier: "_ZTS4pair")
// DIEXPR-IR: [[META82]] = !{[[META83:![0-9]+]], [[META84:![0-9]+]]}
// DIEXPR-IR: [[META83]] = !DIDerivedType(tag: DW_TAG_member, name: "first", scope: [[META81]], file: [[META12]], line: 143, baseType: [[META13]], size: 32)
// DIEXPR-IR: [[META84]] = !DIDerivedType(tag: DW_TAG_member, name: "second", scope: [[META81]], file: [[META12]], line: 143, baseType: [[META13]], size: 32, offset: 32)
// DIEXPR-IR: [[META85]] = !{[[META86:![0-9]+]]}
// DIEXPR-IR: [[META86]] = !DILocalVariable(name: "p", arg: 1, scope: [[META78]], file: [[META12]], line: 160, type: [[META81]])
// DIEXPR-IR: [[META87]] = distinct !DILifetime(object: [[META86]], location: !DIExpr(DIOpReferrer(ptr addrspace(5)), DIOpDeref(%struct.pair)))
// DIEXPR-IR: [[DBG88]] = !DILocation(line: 160, column: 28, scope: [[META78]])
// DIEXPR-IR: [[DBG89]] = !DILocation(line: 160, column: 32, scope: [[META78]])
//.
// DIEXPRESSION-IR: [[META0:![0-9]+]] = !DIGlobalVariableExpression(var: [[META1:![0-9]+]], expr: !DIExpression(DIOpArg(0, ptr addrspace(3)), DIOpDeref(i32)))
// DIEXPRESSION-IR: [[META1]] = distinct !DIGlobalVariable(name: "GlobalSharedA", scope: [[META2:![0-9]+]], file: [[META7:![0-9]+]], line: 12, type: [[META8:![0-9]+]], isLocal: false, isDefinition: true, memorySpace: DW_MSPACE_LLVM_group)
// DIEXPRESSION-IR: [[META2]] = distinct !DICompileUnit(language: DW_LANG_C_plus_plus_14, file: [[META3:![0-9]+]], producer: "{{.*}}clang version {{.*}}", isOptimized: false, runtimeVersion: 0, emissionKind: FullDebug, globals: [[META4:![0-9]+]], splitDebugInlining: false, nameTableKind: None)
// DIEXPRESSION-IR: [[META3]] = !DIFile(filename: "{{.*}}", directory: {{.*}})
// DIEXPRESSION-IR: [[META4]] = !{[[META0]], [[META5:![0-9]+]], [[META9:![0-9]+]], [[META11:![0-9]+]], [[META13:![0-9]+]], [[META15:![0-9]+]], [[META17:![0-9]+]], [[META31:![0-9]+]]}
// DIEXPRESSION-IR: [[META5]] = !DIGlobalVariableExpression(var: [[META6:![0-9]+]], expr: !DIExpression(DIOpArg(0, ptr addrspace(3)), DIOpDeref(i32)))
// DIEXPRESSION-IR: [[META6]] = distinct !DIGlobalVariable(name: "GlobalSharedB", scope: [[META2]], file: [[META7]], line: 13, type: [[META8]], isLocal: false, isDefinition: true, memorySpace: DW_MSPACE_LLVM_group)
// DIEXPRESSION-IR: [[META7]] = !DIFile(filename: "{{.*}}", directory: {{.*}})
// DIEXPRESSION-IR: [[META8]] = !DIBasicType(name: "int", size: 32, encoding: DW_ATE_signed)
// DIEXPRESSION-IR: [[META9]] = !DIGlobalVariableExpression(var: [[META10:![0-9]+]], expr: !DIExpression(DIOpArg(0, ptr addrspace(1)), DIOpDeref(i32)))
// DIEXPRESSION-IR: [[META10]] = distinct !DIGlobalVariable(name: "GlobalDeviceA", scope: [[META2]], file: [[META7]], line: 14, type: [[META8]], isLocal: false, isDefinition: true, memorySpace: DW_MSPACE_LLVM_global)
// DIEXPRESSION-IR: [[META11]] = !DIGlobalVariableExpression(var: [[META12:![0-9]+]], expr: !DIExpression(DIOpArg(0, ptr addrspace(1)), DIOpDeref(i32)))
// DIEXPRESSION-IR: [[META12]] = distinct !DIGlobalVariable(name: "GlobalDeviceB", scope: [[META2]], file: [[META7]], line: 15, type: [[META8]], isLocal: false, isDefinition: true, memorySpace: DW_MSPACE_LLVM_global)
// DIEXPRESSION-IR: [[META13]] = !DIGlobalVariableExpression(var: [[META14:![0-9]+]], expr: !DIExpression(DIOpArg(0, ptr addrspace(4)), DIOpDeref(i32)))
// DIEXPRESSION-IR: [[META14]] = distinct !DIGlobalVariable(name: "GlobalConstantA", scope: [[META2]], file: [[META7]], line: 16, type: [[META8]], isLocal: false, isDefinition: true, memorySpace: DW_MSPACE_LLVM_constant)
// DIEXPRESSION-IR: [[META15]] = !DIGlobalVariableExpression(var: [[META16:![0-9]+]], expr: !DIExpression(DIOpArg(0, ptr addrspace(4)), DIOpDeref(i32)))
// DIEXPRESSION-IR: [[META16]] = distinct !DIGlobalVariable(name: "GlobalConstantB", scope: [[META2]], file: [[META7]], line: 17, type: [[META8]], isLocal: false, isDefinition: true, memorySpace: DW_MSPACE_LLVM_constant)
// DIEXPRESSION-IR: [[META17]] = !DIGlobalVariableExpression(var: [[META18:![0-9]+]], expr: !DIExpression(DIOpArg(0, ptr addrspace(3)), DIOpDeref(i32)))
// DIEXPRESSION-IR: [[META18]] = distinct !DIGlobalVariable(name: "KernelVarSharedA", scope: [[META19:![0-9]+]], file: [[META7]], line: 80, type: [[META8]], isLocal: true, isDefinition: true, memorySpace: DW_MSPACE_LLVM_group)
// DIEXPRESSION-IR: [[META19]] = distinct !DISubprogram(name: "kernel1", linkageName: "_Z7kernel1i", scope: [[META7]], file: [[META7]], line: 79, type: [[META20:![0-9]+]], scopeLine: 79, flags: DIFlagPrototyped, spFlags: DISPFlagDefinition, unit: [[META2]], retainedNodes: [[META22:![0-9]+]])
// DIEXPRESSION-IR: [[META20]] = !DISubroutineType(types: [[META21:![0-9]+]])
// DIEXPRESSION-IR: [[META21]] = !{null, [[META8]]}
// DIEXPRESSION-IR: [[META22]] = !{[[META23]], [[META24]], [[META25]], [[META26]], [[META28]], [[META29]], [[META30]]}
// DIEXPRESSION-IR: [[META23]] = !DILocalVariable(name: "Arg", arg: 1, scope: [[META19]], file: [[META7]], line: 79, type: [[META8]])
// DIEXPRESSION-IR: [[META24]] = !DILocalVariable(name: "KernelVarA", scope: [[META19]], file: [[META7]], line: 82, type: [[META8]])
// DIEXPRESSION-IR: [[META25]] = !DILocalVariable(name: "KernelVarB", scope: [[META19]], file: [[META7]], line: 83, type: [[META8]])
// DIEXPRESSION-IR: [[META26]] = !DILocalVariable(name: "KernelVarSharedAPointer", scope: [[META19]], file: [[META7]], line: 85, type: [[META27:![0-9]+]])
// DIEXPRESSION-IR: [[META27]] = !DIDerivedType(tag: DW_TAG_pointer_type, baseType: [[META8]], size: 64)
// DIEXPRESSION-IR: [[META28]] = !DILocalVariable(name: "KernelVarSharedBPointer", scope: [[META19]], file: [[META7]], line: 86, type: [[META27]])
// DIEXPRESSION-IR: [[META29]] = !DILocalVariable(name: "KernelVarAPointer", scope: [[META19]], file: [[META7]], line: 87, type: [[META27]])
// DIEXPRESSION-IR: [[META30]] = !DILocalVariable(name: "KernelVarBPointer", scope: [[META19]], file: [[META7]], line: 88, type: [[META27]])
// DIEXPRESSION-IR: [[META31]] = !DIGlobalVariableExpression(var: [[META32:![0-9]+]], expr: !DIExpression(DIOpArg(0, ptr addrspace(3)), DIOpDeref(i32)))
// DIEXPRESSION-IR: [[META32]] = distinct !DIGlobalVariable(name: "KernelVarSharedB", scope: [[META19]], file: [[META7]], line: 81, type: [[META8]], isLocal: true, isDefinition: true, memorySpace: DW_MSPACE_LLVM_group)
// DIEXPRESSION-IR: [[META38]] = !DILocation(line: 79, column: 29, scope: [[META19]])
// DIEXPRESSION-IR: [[META39]] = !DILocation(line: 82, column: 7, scope: [[META19]])
// DIEXPRESSION-IR: [[META40]] = !DILocation(line: 83, column: 7, scope: [[META19]])
// DIEXPRESSION-IR: [[META41]] = !DILocation(line: 85, column: 9, scope: [[META19]])
// DIEXPRESSION-IR: [[META42]] = !DILocation(line: 86, column: 9, scope: [[META19]])
// DIEXPRESSION-IR: [[META43]] = !DILocation(line: 87, column: 9, scope: [[META19]])
// DIEXPRESSION-IR: [[META44]] = !DILocation(line: 88, column: 9, scope: [[META19]])
// DIEXPRESSION-IR: [[DBG45]] = !DILocation(line: 89, column: 1, scope: [[META19]])
// DIEXPRESSION-IR: [[META46:![0-9]+]] = distinct !DISubprogram(name: "func1", linkageName: "_Z5func1i", scope: [[META7]], file: [[META7]], line: 135, type: [[META20]], scopeLine: 135, flags: DIFlagPrototyped, spFlags: DISPFlagDefinition, unit: [[META2]], retainedNodes: [[META47:![0-9]+]])
// DIEXPRESSION-IR: [[META47]] = !{[[META48]], [[META49]], [[META50]], [[META51]], [[META52]]}
// DIEXPRESSION-IR: [[META48]] = !DILocalVariable(name: "Arg", arg: 1, scope: [[META46]], file: [[META7]], line: 135, type: [[META8]])
// DIEXPRESSION-IR: [[META49]] = !DILocalVariable(name: "FuncVarA", scope: [[META46]], file: [[META7]], line: 136, type: [[META8]])
// DIEXPRESSION-IR: [[META50]] = !DILocalVariable(name: "FuncVarB", scope: [[META46]], file: [[META7]], line: 137, type: [[META8]])
// DIEXPRESSION-IR: [[META51]] = !DILocalVariable(name: "FuncVarAPointer", scope: [[META46]], file: [[META7]], line: 139, type: [[META27]])
// DIEXPRESSION-IR: [[META52]] = !DILocalVariable(name: "FuncVarBPointer", scope: [[META46]], file: [[META7]], line: 140, type: [[META27]])
// DIEXPRESSION-IR: [[META53]] = !DILocation(line: 135, column: 27, scope: [[META46]])
// DIEXPRESSION-IR: [[META54]] = !DILocation(line: 136, column: 7, scope: [[META46]])
// DIEXPRESSION-IR: [[META55]] = !DILocation(line: 137, column: 7, scope: [[META46]])
// DIEXPRESSION-IR: [[META56]] = !DILocation(line: 139, column: 9, scope: [[META46]])
// DIEXPRESSION-IR: [[META57]] = !DILocation(line: 140, column: 9, scope: [[META46]])
// DIEXPRESSION-IR: [[DBG58]] = !DILocation(line: 141, column: 1, scope: [[META46]])
// DIEXPRESSION-IR: [[META59:![0-9]+]] = distinct !DISubprogram(name: "func1", linkageName: "_Z5func14pair", scope: [[META7]], file: [[META7]], line: 160, type: [[META60:![0-9]+]], scopeLine: 160, flags: DIFlagPrototyped, spFlags: DISPFlagDefinition, unit: [[META2]], retainedNodes: [[META66:![0-9]+]])
// DIEXPRESSION-IR: [[META60]] = !DISubroutineType(types: [[META61:![0-9]+]])
// DIEXPRESSION-IR: [[META61]] = !{null, [[META62:![0-9]+]]}
// DIEXPRESSION-IR: [[META62]] = distinct !DICompositeType(tag: DW_TAG_structure_type, name: "pair", file: [[META7]], line: 143, size: 64, flags: DIFlagTypePassByValue, elements: [[META63:![0-9]+]], identifier: "_ZTS4pair")
// DIEXPRESSION-IR: [[META63]] = !{[[META64:![0-9]+]], [[META65:![0-9]+]]}
// DIEXPRESSION-IR: [[META64]] = !DIDerivedType(tag: DW_TAG_member, name: "first", scope: [[META62]], file: [[META7]], line: 143, baseType: [[META8]], size: 32)
// DIEXPRESSION-IR: [[META65]] = !DIDerivedType(tag: DW_TAG_member, name: "second", scope: [[META62]], file: [[META7]], line: 143, baseType: [[META8]], size: 32, offset: 32)
// DIEXPRESSION-IR: [[META66]] = !{[[META67]]}
// DIEXPRESSION-IR: [[META67]] = !DILocalVariable(name: "p", arg: 1, scope: [[META59]], file: [[META7]], line: 160, type: [[META62]])
// DIEXPRESSION-IR: [[META68]] = !DILocation(line: 160, column: 28, scope: [[META59]])
// DIEXPRESSION-IR: [[DBG69]] = !DILocation(line: 160, column: 32, scope: [[META59]])
//.
