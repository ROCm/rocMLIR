; NOTE: Assertions have been autogenerated by utils/update_llc_test_checks.py UTC_ARGS: --version 2
; RUN: opt -S -mtriple=amdgcn-amd-amdhsa -amdgpu-attributor %s | FileCheck %s

; DAVE-CHECK: define internal void @max_flat_1_1024() #0 {
define internal void @max_flat_1_1024() #0 {
  ret void
}

; CHECK: define internal void @max_flat_1_256() #0 {
define internal void @max_flat_1_256() #0 {
  ret void
}

; CHECK: define amdgpu_kernel void @kernel_1_256_call_default() #0 {
define amdgpu_kernel void @kernel_1_256_call_default() #0 {
  call void @default()
  ret void
}

; CHECK: define amdgpu_kernel void @kernel_1_256_call_1_256() #0 {
define amdgpu_kernel void @kernel_1_256_call_1_256() #0 {
  call void @max_flat_1_256()
  ret void
}

; CHECK: define amdgpu_kernel void @kernel_1_256_call_64_64() #0 {
define amdgpu_kernel void @kernel_1_256_call_64_64() #0 {
  call void @max_flat_64_64()
  ret void
}

; CHECK: define internal void @max_flat_64_64() #1 {
define internal void @max_flat_64_64() #1 {
  ret void
}

; CHECK: define internal void @default() #0 {
define internal void @default() #0 {
  ret void
}

attributes #0 = { noinline "amdgpu-flat-work-group-size"="1,256" }
attributes #1 = { noinline "amdgpu-flat-work-group-size"="64,64" }

; CHECK: attributes #0 = { noinline "amdgpu-flat-work-group-size"="1,256"
; CHECK-NEXT: attributes #1 = { noinline "amdgpu-flat-work-group-size"="64,64"
